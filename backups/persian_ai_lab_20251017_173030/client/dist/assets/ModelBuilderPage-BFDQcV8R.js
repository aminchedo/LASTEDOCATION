import{c as k,j as e,W as I,B as h,s as w,b as r,A as L,S,G as c,D as A,Z as z,P as B,a4 as p}from"./index-Br5p3c61.js";import{b as u}from"./react-vendor-CHIk2tMd.js";import{S as i}from"./Select-DwYsi9Sj.js";import{P as E}from"./Progress-48by0XhX.js";import{u as T}from"./useAILab-Cx0UAcfI.js";import{aJ as R,aK as J,aL as P,aM as D,aN as K,aO as M,aQ as G,aP as o}from"./LineChart-BHDkt2Nk.js";import{C as g}from"./code-goAM4Hpk.js";import"./api-BM4dxxsF.js";import"./auth.service-DTA6mi50.js";/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const V=k("Layers",[["path",{d:"m12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83Z",key:"8b97xw"}],["path",{d:"m22 17.65-9.17 4.16a2 2 0 0 1-1.66 0L2 17.65",key:"dd6zsq"}],["path",{d:"m22 12.65-9.17 4.16a2 2 0 0 1-1.66 0L2 12.65",key:"ep9fru"}]]);function Y(){const{datasets:f,activeJobs:m,startTraining:N,isConnected:d}=T(),[a,t]=u.useState({name:"",type:"tts",architecture:"transformer",datasetId:"",layers:12,parameters:{learningRate:.001,batchSize:32,epochs:100,optimizer:"adam"}}),[y,j]=u.useState(!1),[x,v]=u.useState(null),l=m.find(s=>s.jobId===x),b=l?.metrics.loss.map((s,n)=>({epoch:n+1,loss:s,accuracy:l.metrics.accuracy[n],valLoss:l.metrics.validationLoss[n],valAccuracy:l.metrics.validationAccuracy[n]}))||[],C=async()=>{if(!a.name){p.error("لطفاً نام مدل را وارد کنید");return}if(!a.datasetId){p.error("لطفاً یک دیتاست انتخاب کنید");return}j(!0);try{const s=await N(a);v(s),p.success("آموزش مدل شروع شد")}catch(s){console.error("Failed to start training:",s)}finally{j(!1)}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-8",children:[e.jsxs("h1",{className:"text-3xl font-bold flex items-center gap-3",children:[e.jsx(I,{className:"w-8 h-8 text-[color:var(--c-primary)]"}),"سازنده مدل"]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:`w-3 h-3 rounded-full ${d?"bg-green-500":"bg-red-500"}`}),e.jsx("span",{className:"text-sm",children:d?"متصل":"قطع شده"})]}),e.jsx(h,{variant:"primary",icon:e.jsx(w,{className:"w-4 h-4"}),onClick:C,loading:y,disabled:!d,children:"شروع آموزش مدل"})]})]}),m.length>0&&e.jsxs(r,{className:"p-6 mb-6",children:[e.jsxs("h2",{className:"text-xl font-semibold mb-4 flex items-center gap-2",children:[e.jsx(L,{className:"w-5 h-5"}),"کارهای آموزش فعال"]}),e.jsx("div",{className:"space-y-3",children:m.map(s=>e.jsxs("div",{className:`p-4 border rounded-lg cursor-pointer transition-colors ${x===s.jobId?"border-[color:var(--c-primary)] bg-[color:var(--c-bg-elevated)]":"border-[color:var(--c-border)]"}`,onClick:()=>v(s.jobId),children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsxs("span",{className:"font-medium",children:["Job ID: ",s.jobId.substring(0,8),"..."]}),e.jsx("span",{className:`px-2 py-1 rounded text-xs ${s.status==="completed"?"bg-green-100 text-green-800":s.status==="failed"?"bg-red-100 text-red-800":"bg-blue-100 text-blue-800"}`,children:s.status})]}),e.jsx(E,{value:s.progress,className:"mb-2"}),s.currentEpoch&&s.totalEpochs&&e.jsxs("p",{className:"text-sm text-[color:var(--c-text-secondary)]",children:["Epoch ",s.currentEpoch," از ",s.totalEpochs]})]},s.jobId))})]}),x&&l&&b.length>0&&e.jsxs(r,{className:"p-6 mb-6",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"معیارهای آموزش"}),e.jsx("div",{className:"h-64",children:e.jsx(R,{width:"100%",height:"100%",children:e.jsxs(J,{data:b,children:[e.jsx(P,{strokeDasharray:"3 3"}),e.jsx(D,{dataKey:"epoch",label:{value:"Epoch",position:"insideBottom",offset:-5}}),e.jsx(K,{}),e.jsx(M,{}),e.jsx(G,{}),e.jsx(o,{type:"monotone",dataKey:"loss",stroke:"#8884d8",name:"Loss"}),e.jsx(o,{type:"monotone",dataKey:"accuracy",stroke:"#82ca9d",name:"Accuracy"}),e.jsx(o,{type:"monotone",dataKey:"valLoss",stroke:"#ffc658",name:"Val Loss"}),e.jsx(o,{type:"monotone",dataKey:"valAccuracy",stroke:"#ff7c7c",name:"Val Accuracy"})]})})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(r,{className:"p-6",children:[e.jsxs("h2",{className:"text-xl font-semibold mb-4 flex items-center gap-2",children:[e.jsx(S,{className:"w-5 h-5"}),"تنظیمات پایه"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"نام مدل"}),e.jsx(c,{value:a.name,onChange:s=>t({...a,name:s.target.value}),placeholder:"مثال: persian-tts-v2"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"نوع مدل"}),e.jsxs(i,{value:a.type,onChange:s=>t({...a,type:s.target.value}),children:[e.jsx("option",{value:"tts",children:"تبدیل متن به گفتار (TTS)"}),e.jsx("option",{value:"stt",children:"تبدیل گفتار به متن (STT)"}),e.jsx("option",{value:"nlp",children:"پردازش زبان طبیعی (NLP)"}),e.jsx("option",{value:"cv",children:"بینایی ماشین (CV)"}),e.jsx("option",{value:"custom",children:"سفارشی"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"معماری"}),e.jsxs(i,{value:a.architecture,onChange:s=>t({...a,architecture:s.target.value}),children:[e.jsx("option",{value:"transformer",children:"Transformer"}),e.jsx("option",{value:"lstm",children:"LSTM"}),e.jsx("option",{value:"cnn",children:"CNN"}),e.jsx("option",{value:"gru",children:"GRU"}),e.jsx("option",{value:"bert",children:"BERT"}),e.jsx("option",{value:"custom",children:"سفارشی"})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium mb-2 flex items-center gap-2",children:[e.jsx(A,{className:"w-4 h-4"}),"دیتاست"]}),e.jsxs(i,{value:a.datasetId,onChange:s=>t({...a,datasetId:s.target.value}),children:[e.jsx("option",{value:"",children:"انتخاب دیتاست..."}),f.map(s=>e.jsxs("option",{value:s.id,children:[s.name," (",s.stats.rows," ردیف)"]},s.id))]})]})]})]}),e.jsxs(r,{className:"p-6",children:[e.jsxs("h2",{className:"text-xl font-semibold mb-4 flex items-center gap-2",children:[e.jsx(V,{className:"w-5 h-5"}),"پیکربندی معماری"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"تعداد لایه‌ها"}),e.jsx(c,{type:"number",value:a.layers,onChange:s=>t({...a,layers:parseInt(s.target.value)}),min:1,max:100})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"نرخ یادگیری"}),e.jsx(c,{type:"number",value:a.parameters.learningRate,onChange:s=>t({...a,parameters:{...a.parameters,learningRate:parseFloat(s.target.value)}}),step:1e-4,min:1e-4,max:1})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"اندازه دسته"}),e.jsx(c,{type:"number",value:a.parameters.batchSize,onChange:s=>t({...a,parameters:{...a.parameters,batchSize:parseInt(s.target.value)}}),min:1,max:512})]})]})]}),e.jsxs(r,{className:"p-6",children:[e.jsxs("h2",{className:"text-xl font-semibold mb-4 flex items-center gap-2",children:[e.jsx(z,{className:"w-5 h-5"}),"پارامترهای آموزش"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"تعداد epoch"}),e.jsx(c,{type:"number",value:a.parameters.epochs,onChange:s=>t({...a,parameters:{...a.parameters,epochs:parseInt(s.target.value)}}),min:1,max:1e3})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"بهینه‌ساز"}),e.jsxs(i,{value:a.parameters.optimizer,onChange:s=>t({...a,parameters:{...a.parameters,optimizer:s.target.value}}),children:[e.jsx("option",{value:"adam",children:"Adam"}),e.jsx("option",{value:"sgd",children:"SGD"}),e.jsx("option",{value:"rmsprop",children:"RMSprop"}),e.jsx("option",{value:"adagrad",children:"Adagrad"})]})]})]})]}),e.jsxs(r,{className:"p-6",children:[e.jsxs("h2",{className:"text-xl font-semibold mb-4 flex items-center gap-2",children:[e.jsx(g,{className:"w-5 h-5"}),"پیش‌نمایش پیکربندی"]}),e.jsx("pre",{className:"bg-[color:var(--c-bg-elevated)] p-4 rounded-lg text-sm overflow-auto",children:JSON.stringify(a,null,2)}),e.jsxs("div",{className:"mt-4 flex gap-2",children:[e.jsx(h,{variant:"secondary",icon:e.jsx(B,{className:"w-4 h-4"}),size:"sm",disabled:!a.name||!a.datasetId,children:"اجرای آزمایشی"}),e.jsx(h,{variant:"ghost",icon:e.jsx(g,{className:"w-4 h-4"}),size:"sm",children:"صدور کد"})]})]})]})]})}export{Y as ModelBuilderPage};
