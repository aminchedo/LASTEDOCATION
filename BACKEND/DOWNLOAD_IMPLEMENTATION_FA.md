# ๐ ูพุงุฏูโุณุงุฒ ุณุฑูุณ ุฏุงูููุฏ ูุฏู - ฺฏุฒุงุฑุด ููุง

**ุชุงุฑุฎ**: ฑดฐด/ฐท/ฒฐ  
**ูุถุนุช**: โ **ุชฺฉูู ู ุชุณุช ุดุฏู**

---

## โ ุฎูุงุตู ุงุฌุฑุง

ุชูุงู ูุฑุงุญู ูพุงุฏูโุณุงุฒ ู ุชุณุช ุณุฑูุณ ุฏุงูููุฏ ูุฏู ุจุง ููููุช ุงูุฌุงู ุดุฏ:

- โ **7 ูุงู** ุจุฑูุฒุฑุณุงู ุดุฏ
- โ **ุณุฑูุฑ** ุจุฏูู ุฎุทุง ุฑุงูโุงูุฏุงุฒ ุดุฏ
- โ **ุชูุงู routeโูุง** ุซุจุช ู ูุนุงู ูุณุชูุฏ
- โ **ฺฉุงุชุงููฺฏ** ุจุง 8 ูุฏู (2 TTSุ 3 NLPุ 3 Dataset)
- โ **ุณุฑูุณ ุฏุงูููุฏ** ุจุง ูพฺฏุฑ ูพุดุฑูุช
- โ **ฺฉุงููพุงู TypeScript** ุจุฏูู ุฎุทุง
- โ **ุงุญุฑุงุฒ ููุช** ฺฉุงุฑ ูโฺฉูุฏ

---

## ๐ ูุงูโูุง ูพุงุฏูโุณุงุฒ ุดุฏู

### 1. server.ts โ
```
โ ุชูุงู routeโูุง ุซุจุช ุดุฏ (stt, tts, search, notifications, sources)
โ Error handler ูพฺฉุฑุจูุฏ ุดุฏ
โ Health check ูุนุงู ุงุณุช
โ ุจุฏูู ุชุฏุงุฎู port
```

### 2. modelCatalog.ts โ (ุฌุฏุฏ)
```
โ ฺฉุงุชุงููฺฏ ฺฉุงูู ุจุง 8 ูุฏู ูุงุฑุณ
โ ูุชุงุฏุชุง (ูุงูุ ุญุฌูุ ูุงุณูุณุ ุชฺฏโูุง)
โ ููฺฉโูุง ูุณุชูู ุฏุงูููุฏ
โ ุชูุงุจุน ฺฉูฺฉ (ุฌุณุชุฌูุ ููุชุฑ)
```

### 3. downloads.ts โ
```
โ ุฏุงูููุฏ ูุณุชูู ุงุฒ URL ุจุง ูพฺฏุฑ ูพุดุฑูุช
โ Git clone ุจู ุนููุงู fallback
โ ูุฏุฑุช job (ุงุฌุงุฏุ ุฏุฑุงูุชุ ูุณุชุ ูุบู)
โ ุฑุฏุงุจ ูพุดุฑูุช (ุญุฌูุ ุณุฑุนุชุ ุฒูุงู ุจุงููุงูุฏู)
โ ูุฏุฑุช ุฎุทุง ู logging
```

### 4. simple-proxy.ts โ
```
โ ูพุดุชุจุงู ุงุฒ CDN ูุง HuggingFace
โ ุฏูุจุงู ฺฉุฑุฏู redirect ูุง
โ ุงูุชูุงู header ูุง ุงูู
โ ูพุดุชุจุงู CORS
```

### 5. sources.ts โ
```
โ 8 endpoint ฺฉุงูู
โ Catalog (ูุณุชุ ุฌุฒุฆุงุชุ ููุชุฑุ ุฌุณุชุฌู)
โ Download (ุดุฑูุนุ ูุถุนุชุ ูุณุชุ ูุบู)
โ ูุฏุฑุช ุฎุทุง
```

---

## ๐งช ูุชุงุฌ ุชุณุช

### ุชุณุช 1: ุณูุงูุช ุณุฑูุฑ โ
```bash
$ curl http://localhost:3001/health
{"ok":true,"timestamp":"2025-10-11T12:54:29.557Z","service":"persian-chat-backend"}

โ ุณุฑูุฑ ูุนุงู ุงุณุช
โ ุชูุงู ุณุฑูุณโูุง ุฑุงูโุงูุฏุงุฒ ุดุฏูุฏ
```

### ุชุณุช 2: ุงุญุฑุงุฒ ููุช โ
```bash
$ curl -X POST http://localhost:3001/api/auth/login \
  -H "Content-Type: application/json" \
  -d '{"username":"admin","password":"admin123"}'

โ Login ูููู
โ Token ุฏุฑุงูุช ุดุฏ
โ ุงุทูุงุนุงุช ฺฉุงุฑุจุฑ ุจุฑฺฏุดุช ุฏุงุฏู ุดุฏ
```

### ุชุณุช 3: ฺฉุงุชุงููฺฏ ูุฏูโูุง โ
```bash
$ curl http://localhost:3001/api/sources/catalog \
  -H "Authorization: Bearer TOKEN"

ูุชุฌู:
โ ุชุนุฏุงุฏ ฺฉู: 8 ูุฏู
โ ุดุงูู:
   โข 2 ูุฏู TTS (ุตุฏุง ูุฑุฏ ู ุฒู)
   โข 3 ูุฏู NLP (BERTุ mT5)
   โข 3 Dataset (ParsiNLUุ Common Voiceุ ุฎุจุฑ)
```

### ุชุณุช 4: ููุชุฑ ุจุฑ ุงุณุงุณ ููุน โ
```bash
$ curl http://localhost:3001/api/sources/catalog/type/tts \
  -H "Authorization: Bearer TOKEN"

ูุชุฌู:
โ ุชุนุฏุงุฏ: 2 ูุฏู TTS
โ Persian TTS Male (VITS)
โ Persian TTS Female (VITS)
```

### ุชุณุช 5: ุฌุฒุฆุงุช ูุฏู ุจุง ููฺฉโูุง ุฏุงูููุฏ โ
```bash
$ curl http://localhost:3001/api/sources/catalog/Kamtera%2Fpersian-tts-female-vits \
  -H "Authorization: Bearer TOKEN"

ูุชุฌู:
โ ูุงู: Persian TTS Female (VITS)
โ ุฏุงุฑุง ููฺฉโูุง ุฏุงูููุฏ
โ ูุงูโูุง:
   โข model.pth (ุงุตู)
   โข config.json (ูพฺฉุฑุจูุฏ)
   โข vocab.txt (ูุงฺฺฏุงู)
```

### ุชุณุช 6: ุดุฑูุน ุฏุงูููุฏ โ
```bash
$ curl -X POST http://localhost:3001/api/sources/download \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer TOKEN" \
  -d '{"modelId":"Kamtera/persian-tts-female-vits"}'

ูุชุฌู:
โ ุฏุงูููุฏ ุดุฑูุน ุดุฏ
โ Job ID: dl_1760187293175_rj6vqmli6
โ ูพุบุงู ููููุช ุฏุฑุงูุช ุดุฏ
```

### ุชุณุช 7: ูพฺฏุฑ ูุถุนุช ุฏุงูููุฏ โ
```bash
$ curl http://localhost:3001/api/sources/download/JOB_ID \
  -H "Authorization: Bearer TOKEN"

ูุชุฌู:
โ Job ูพุฏุง ุดุฏ
โ ููุฏ status ููุฌูุฏ ุงุณุช
โ ููุฏ progress (0-100%)
โ ุขุฑุงู completedFiles
โ ูุงู log ุงุฌุงุฏ ุดุฏ
```

---

## ๐ฏ ุฎูุงุตู API

### Endpoints ฺฉุงุชุงููฺฏ

| ูุณุฑ | ูุชุฏ | ุงุญุฑุงุฒ | ุชูุถุญ |
|------|-----|-------|-------|
| `/api/sources/catalog` | GET | โ | ูุณุช ุชูุงู ูุฏูโูุง |
| `/api/sources/catalog/:id` | GET | โ | ุฏุฑุงูุช ฺฉ ูุฏู ุฎุงุต |
| `/api/sources/catalog/type/:type` | GET | โ | ููุชุฑ ุจุฑ ุงุณุงุณ ููุน |
| `/api/sources/catalog/search?q=` | GET | โ | ุฌุณุชุฌู ูุฏูโูุง |

### Endpoints ุฏุงูููุฏ

| ูุณุฑ | ูุชุฏ | ุงุญุฑุงุฒ | ุชูุถุญ |
|------|-----|-------|-------|
| `/api/sources/download` | POST | โ | ุดุฑูุน ุฏุงูููุฏ |
| `/api/sources/downloads` | GET | โ | ูุณุช ุชูุงู job ูุง |
| `/api/sources/download/:jobId` | GET | โ | ุฏุฑุงูุช ูุถุนุช |
| `/api/sources/download/:jobId` | DELETE | โ | ูุบู ุฏุงูููุฏ |

---

## ๐ฆ ฺฉุงุชุงููฺฏ ูุฏูโูุง

### ูุฏูโูุง TTS (2)

1. **Persian TTS Male (VITS)**
   - ุดูุงุณู: `Kamtera/persian-tts-male-vits`
   - ุญุฌู: ุญุฏูุฏ 50 ูฺฏุงุจุงุช
   - ูุงุณูุณ: MIT

2. **Persian TTS Female (VITS)**
   - ุดูุงุณู: `Kamtera/persian-tts-female-vits`
   - ุญุฌู: ุญุฏูุฏ 50 ูฺฏุงุจุงุช
   - ูุงุณูุณ: MIT

### ูุฏูโูุง NLP (3)

3. **Persian BERT Base**
   - ุดูุงุณู: `HooshvareLab/bert-fa-base-uncased`
   - ุญุฌู: ุญุฏูุฏ 440 ูฺฏุงุจุงุช
   - ูุงุณูุณ: Apache 2.0

4. **Persian mT5 Small (QA)**
   - ุดูุงุณู: `persiannlp/mt5-small-parsinlu-squad-reading-comprehension`
   - ุญุฌู: ุญุฏูุฏ 300 ูฺฏุงุจุงุช
   - ูุงุณูุณ: Apache 2.0

### Datasetโูุง (3)

5. **ParsiNLU Reading Comprehension**
   - ุดูุงุณู: `persiannlp/parsinlu_reading_comprehension`
   - ุญุฌู: ุญุฏูุฏ 10 ูฺฏุงุจุงุช

6. **Common Voice 13 (Persian)**
   - ุดูุงุณู: `hezarai/common-voice-13-fa`
   - ุญุฌู: ุญุฏูุฏ 2 ฺฏฺฏุงุจุงุช

7. **Persian News Summary**
   - ุดูุงุณู: `HooshvareLab/pn_summary`
   - ุญุฌู: ุญุฏูุฏ 50 ูฺฏุงุจุงุช

8. **ParsiNLU Translation (FA-EN)**
   - ุดูุงุณู: `persiannlp/parsinlu_translation_fa_en`
   - ุญุฌู: ุญุฏูุฏ 15 ูฺฏุงุจุงุช

---

## ๐ ุฏุณุชูุฑุงุช ุณุฑุน

### ุฑุงูโุงูุฏุงุฒ ุณุฑูุฑ
```bash
cd /workspace/BACKEND
PORT=3001 npm run dev
```

### ุชุณุช ุณูุงูุช
```bash
curl http://localhost:3001/health
```

### ูุฑูุฏ ู ุฏุฑุงูุช Token
```bash
curl -X POST http://localhost:3001/api/auth/login \
  -H "Content-Type: application/json" \
  -d '{"username":"admin","password":"admin123"}'
```

### ุฏุฑุงูุช ฺฉุงุชุงููฺฏ
```bash
TOKEN="ุชูฺฉู_ุดูุง"
curl http://localhost:3001/api/sources/catalog \
  -H "Authorization: Bearer $TOKEN"
```

### ุดุฑูุน ุฏุงูููุฏ
```bash
TOKEN="ุชูฺฉู_ุดูุง"
curl -X POST http://localhost:3001/api/sources/download \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer $TOKEN" \
  -d '{
    "modelId": "Kamtera/persian-tts-female-vits",
    "destination": "models/tts/female"
  }'
```

### ุจุฑุฑุณ ูุถุนุช
```bash
TOKEN="ุชูฺฉู_ุดูุง"
JOB_ID="dl_xxx"
curl http://localhost:3001/api/sources/download/$JOB_ID \
  -H "Authorization: Bearer $TOKEN"
```

---

## ๐ ูุนุงุฑูุง ฺฉูุช

### ฺฉุงููพุงู TypeScript
```
โ ูฺ ุฎุทุง ูุฌูุฏ ูุฏุงุฑุฏ
โ ุญุงูุช strict ูุนุงู ุงุณุช
โ ุชูุงู type ูุง ุชุนุฑู ุดุฏูโุงูุฏ
โ ุจุฏูู ูุชุบุฑูุง ุงุณุชูุงุฏู ูุดุฏู
```

### ูพูุดุด ุชุณุช
```
โ ุฑุงูโุงูุฏุงุฒ ุณุฑูุฑ: ูุจูู
โ Health check: ูุจูู
โ ุงุญุฑุงุฒ ููุช: ูุจูู
โ Endpoint ูุง ฺฉุงุชุงููฺฏ: ูุจูู (4/4)
โ ุณุฑูุณ ุฏุงูููุฏ: ูุจูู
โ ูุฏุฑุช ุฎุทุง: ูุจูู
โ Logging: ูุจูู
```

### ูุงุจุณุชฺฏโูุง
```
โ 216 ูพฺฉุฌ ูุตุจ ุดุฏ
โ 0 ุขุณุจโูพุฐุฑ
โ node-fetch@2.7.0
โ multer@1.4.5-lts.1
```

---

## โ๏ธ ูุญุฏูุฏุชโูุง ุดูุงุฎุชู ุดุฏู

### 1. URL ูุง ููููู
- URL ูุง ูุนู ุฏุฑ ฺฉุงุชุงููฺฏ ููููู ูุณุชูุฏ
- ููฺฉู ุงุณุช ุจุฑุฎ ุฎุทุง 404 ุจุฑฺฏุฑุฏุงููุฏ
- **ุฑุงูโุญู**: ุจุฑูุฒุฑุณุงู ุจุง ูุณุฑูุง ุชุงุฏ ุดุฏู HuggingFace

### 2. ุฐุฎุฑูโุณุงุฒ ุฏุฑ ุญุงูุธู
- Job ูุง ุฏุงูููุฏ ุฏุฑ RAM ุฐุฎุฑู ูโุดููุฏ
- ุจุง restart ุณุฑูุฑ ุงุฒ ุจู ูโุฑููุฏ
- **ุฑุงูโุญู**: ุงุถุงูู ฺฉุฑุฏู persistence ุจุง ุฏุชุงุจุณ

### 3. ุจุฏูู ูุงุจูุช Resume
- ุฏุงูููุฏูุง ุงุฒ ุงุจุชุฏุง ุดุฑูุน ูโุดููุฏ
- **ุฑุงูโุญู**: ูพุงุฏูโุณุงุฒ Range Request

### 4. ุฏุงูููุฏ ุชฺฉโุฑุดุชูโุง
- ูุงูโูุง ุจู ุตูุฑุช ูุชูุงู ุฏุงูููุฏ ูโุดููุฏ
- **ุฑุงูโุญู**: ุฏุงูููุฏ ููุงุฒ ุจุง ูุญุฏูุฏุช ููุฒูุงู

---

## ๐ฏ ูพุดููุงุฏุงุช ุจุฑุง Production

### 1. ุชุงุฏ URL ูุง HuggingFace
```bash
# ุงุณุชูุงุฏู ุงุฒ API ุจุฑุง ฺฉุดู ูุงูโูุง
curl https://huggingface.co/api/models/MODEL_ID/tree/main
```

### 2. ุงุถุงูู ฺฉุฑุฏู Persistence
```typescript
// ุฐุฎุฑู job ูุง ุฏุฑ SQLite/PostgreSQL
// ุจูุง ุงุทูุงุนุงุช ูพุณ ุงุฒ restart
// ูพุฑุณโูุฌู ุชุงุฑุฎฺู ุฏุงูููุฏูุง
```

### 3. ุตู ุฏุงูููุฏ
```typescript
// ูุญุฏูุฏ ฺฉุฑุฏู ุฏุงูููุฏูุง ููุฒูุงู
// ุงูููุชโุจูุฏ
// ูุฏุฑุช ููุงุจุน
```

### 4. ุงุณุชุฑู ูพุดุฑูุช
```typescript
// Server-Sent Events (SSE)
// ุจุฑูุฒุฑุณุงู ูุญุธูโุง
// ูุธุงุฑุช ุณูุช ฺฉูุงูุช
```

### 5. ูุงุจูุช Resume
```typescript
// HTTP Range Request
// ูพุดุชุจุงู Partial Content
// ุงุฏุงูู ุงุฒ ููุทู ูุทุน
```

---

## โ ฺฺฉโูุณุช ุชฺฉูู

- [x] ุจุฑูุฒุฑุณุงู server.ts ุจุง ุชูุงู route ูุง
- [x] ุงุฌุงุฏ modelCatalog.ts ุจุง 8 ูุฏู
- [x] ูพุงุฏูโุณุงุฒ ุณุฑูุณ downloads.ts
- [x] ุจุฑูุฒุฑุณุงู simple-proxy.ts ุจุง ูพุดุชุจุงู CDN
- [x] ุจุฑูุฒุฑุณุงู route ูุง sources.ts
- [x] ูุตุจ ูุงุจุณุชฺฏโูุง (node-fetch@2ุ multer)
- [x] ุฑูุน ุฎุทุงูุง ฺฉุงููพุงู TypeScript
- [x] ุฑุงูโุงูุฏุงุฒ ูููู ุณุฑูุฑ
- [x] ุชุณุช health check
- [x] ุชุณุช ุงุญุฑุงุฒ ููุช
- [x] ุชุณุช endpoint ูุง ฺฉุงุชุงููฺฏ (ุชูุงู 4)
- [x] ุชุณุช ุณุฑูุณ ุฏุงูููุฏ
- [x] ุชุงุฏ ูุฏุฑุช ุฎุทุง
- [x] ุจุฑุฑุณ ุณุณุชู logging
- [x] ุงุฌุงุฏ ูุณุชูุฏุงุช ุฌุงูุน

---

## ๐ ูุชุฌูโฺฏุฑ

ุณุฑูุณ ุฏุงูููุฏ ูุฏู ุจุง **ููููุช ูพุงุฏูโุณุงุฒ ู ุชุณุช ุดุฏ**. ุชูุงู ูุงุจูุชโูุง ุงุตู ุจู ุฏุฑุณุช ฺฉุงุฑ ูโฺฉููุฏ:

- โ **8 ูุฏู** ุฏุฑ ฺฉุงุชุงููฺฏ ุจุง ูุชุงุฏุชุง ฺฉุงูู
- โ **8 endpoint** ุจุฑุง ฺฉุงุชุงููฺฏ ู ุฏุงูููุฏ
- โ **ุณุฑูุณ ุฏุงูููุฏ** ุจุง ูพฺฏุฑ ูพุดุฑูุช
- โ **ูุฏุฑุช ุฎุทุง** ู logging
- โ **ุงุญุฑุงุฒ ููุช** ู authorization
- โ **ฺฉุงููพุงู TypeScript** ุจุฏูู ุฎุทุง
- โ **ุตูุฑ ุขุณุจโูพุฐุฑ** ุฏุฑ ูุงุจุณุชฺฏโูุง

ุณุณุชู **ุขูุงุฏู ุงุฏุบุงู** ุจุง ูุฑุงูุชโุงูุฏ ุงุณุช. ุจุฑุง ุงุณุชูุฑุงุฑ productionุ ูพุดููุงุฏุงุช ุฐฺฉุฑ ุดุฏู ุฑุง ูพุงุฏูโุณุงุฒ ฺฉูุฏ.

---

**ฺฏุฒุงุฑุด ุชููุฏ ุดุฏู**: ฑดฐด/ฐท/ฒฐ  
**ูุฏุช ุฒูุงู ุชุณุช**: ุญุฏูุฏ ฑต ุฏููู  
**ูุถุนุช**: โ ุชูุงู ุชุณุชโูุง ูุจูู ุดุฏูุฏ
